generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Source {
  FACEBOOK @map("facebook")
  TIKTOK   @map("tiktok")
}

enum FunnelStage {
  TOP    @map("top")
  BOTTOM @map("bottom")
}

enum FacebookEventType {
  AD_VIEW           @map("ad.view")
  PAGE_LIKE         @map("page.like")
  COMMENT           @map("comment")
  VIDEO_VIEW        @map("video.view")
  AD_CLICK          @map("ad.click")
  FORM_SUBMISSION   @map("form.submission")
  CHECKOUT_COMPLETE @map("checkout.complete")
}

model FacebookEvent {
  id           String             @id
  timestamp    DateTime
  source       Source
  funnelStage  FunnelStage
  eventType    FacebookEventType
  userId       String
  user         FacebookUser       @relation(fields: [userId], references: [id])
  engagement   Json

  @@map("facebook_events")
}

model FacebookUser {
  id       String                @id
  name     String
  age      Int
  gender   String
  location Json
  events   FacebookEvent[]

  @@map("facebook_users")
}

enum TiktokEventType {
  VIDEO_VIEW    @map("video.view")
  LIKE          @map("like")
  SHARE         @map("share")
  COMMENT       @map("comment")
  PROFILE_VISIT @map("profile_visit")
  PURCHASE      @map("purchase")
  FOLLOW        @map("follow")
}

model TiktokUser {
  id        String        @id
  username  String
  followers Int
  events    TiktokEvent[]
}

model TiktokEvent {
  id          String          @id
  timestamp   DateTime
  source      Source
  funnelStage FunnelStage
  eventType   TiktokEventType

  userId String
  user   TiktokUser @relation(fields: [userId], references: [id])

  engagement Json
}
